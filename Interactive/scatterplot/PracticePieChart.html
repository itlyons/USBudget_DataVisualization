
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Practice Scatter Plot</title>
        <script type="text/javascript" src="d3/d3.js"></script>
    </head>
    <body>
        <script type="text/javascript">

            /*
                var cbo = d3.json("data/SuperSimple.json", function(data) {
                console.log(data);
                });

                */

            const w = 500;
            const h = 500;
            const r = 150;
            const color = d3.scaleOrdinal(d3.schemeDark2);

            // For now, define the data directly since loading JSON is hard.
            var cbo = [{"SpendCategory": "Defense", "proj_2027": 740392, "proj_2019": 664158}
,{"SpendCategory": "Nondefense", "proj_2027": 724210, "proj_2019": 669892}
,{"SpendCategory": "Medicaid", "proj_2027": 625803, "proj_2019": 405935}
,{"SpendCategory": "Medicare", "proj_2027": 1354566, "proj_2019": 768066}
,{"SpendCategory": "Net Interest", "proj_2027": 821122, "proj_2019": 383489}
,{"SpendCategory": "Offsetting receipts", "proj_2027": -399759, "proj_2019": -282638}
,{"SpendCategory": "Other Spending", "proj_2027": 916201, "proj_2019": 764250}
,{"SpendCategory": "Social Security", "proj_2027": 1663960, "proj_2019": 1039092}
];


            const vis = d3.select("body")
                .append("svg:svg")
                .data([cbo])
                .attr("width", w)
                .attr("height", h)
                    //make a group to hold our pie chart
                .append("svg:g")
                  // move the center of the pie chart from 0, 0 to radius, radius
                  // node the string templating syntax here
                .attr("transform", `translate(${r},${r})`)

            //this will create <path> elements for us using arc data
            const arc = d3.arc()
              .outerRadius(r)
              .innerRadius(0);

            //this will create arc data for us given a list of values
            const pie = d3.pie()
                // we must tell it how to access the value of each element in our data array
               .value(d => d.proj_2019);
                    // you could also write this function explicitly, as below, but the arrow is better
                    // .value(function(d) { return d.value; });


            //this selects all <g> elements with class slice (there aren't any yet)
            var arcs = vis.selectAll("g.slice")
              // associate the generated pie data (an array of arcs, each having startAngle, endAngle and value properties)
              .data(pie)
              .enter()
                  // this will create <g> elements for every "extra" data element that should be associated with a selection.
                  // The result is creating a <g> for every object in the data array create a group to hold each slice
                  // (we will have a <path> and a <text> element associated with each slice)
                .append("svg:g")
                    //allow us to style things in the slices (like text)
                .attr("class", "slice");


            arcs.append("svg:path")
                //set the color for each slice to be chosen from the color function defined above
                // again note the arrow
            .attr("fill", (d, i) => color(i))
                //this creates the actual SVG path using the associated data (pie) with the arc drawing function
            .attr("d", arc);


            //add a label to each slice
            arcs.append("svg:text")
              //set the label's origin to the center of the arc
              .attr("transform", function(d) {
                  //we have to make sure to set these before calling arc.centroid
                  d.innerRadius = 0;
                  d.outerRadius = r;
                  //this gives us a pair of coordinates like [50, 50]
                  return `translate(${arc.centroid(d)})`;
              })
              //center the text on it's origin
              .attr("text-anchor", "middle")
              //get the label from our original data array
              .text((d, i) => cbo[i].SpendCategory);

        </script>
    </body>
</html>
